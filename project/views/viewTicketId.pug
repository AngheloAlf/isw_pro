extends layout_index

block content
    #wrapper
        //sidebar
        include sidebarInclude

        // Page Content
        #page-content-wrapper
            .container-fluid
                .row.col-lg-12
                    h1 Sistema de gestión de tickets
                    a#menu-toggle.btn.btn-default(href='#menu-toggle') Menu
                    br
                    p
                    //form(action="/users", method="GET")
                    //            button.btn.btn-primary.btn-lg Volver atrás
                    br
                    p#ticketId(hidden="") #{ticketId}
                    br
                    div(ng-app='assignTicket', ng-controller='assignTicketCtrl')
                        .container
                            .row
                                .col-md-12
                                    .well.well-sm
                                        fieldset
                                            legend.text-center.header Informacion del ticket
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p id: {{ ticketData.id }}

                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p propietario: {{ ticketData.propietario }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p fecha_creacion: {{ ticketData.fecha_creacion }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p encargado: {{ ticketData.encargado }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p fuente: {{ ticketData.fuente }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p ip_origen: {{ ticketData.ip_origen }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p ip_destino: {{ ticketData.ip_destino }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p puerto: {{ ticketData.puerto }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p protocolo: {{ ticketData.protocolo }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p tipo: {{ ticketData.tipo }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p intencionalidad: {{ ticketData.intencionalidad }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p subarea: {{ ticketData.subarea }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p sistema_seguridad: {{ ticketData.sistema_seguridad }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p fecha_operacion: {{ ticketData.fecha_operacion }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p dias_transcurridos: {{ ticketData.dias_transcurridos }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p comentarios: {{ ticketData.comentarios }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p correo_origen: {{ ticketData.correo_origen }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p correo_afectado: {{ ticketData.correo_afectado }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p eliminado: {{ ticketData.eliminado }}
                                            .form-group
                                                span.col-md-1.col-md-offset-2.text-center
                                                .col-md-8
                                                    p eliminado por: {{ ticketData.eliminado_por }}


                        .container
                            .row
                                .rwd
                                    table.rwd_auto
                                        thead
                                            tr
                                                th Antecedente
                                                th Usuario
                                                th Fecha
                                                th Visado
                                                th Archivo adjunto
                                        tbody
                                            tr(ng-repeat="ticket in ticketsDataData")
                                                td {{ ticket.antecedente }}
                                                td {{ ticket.userId }}
                                                td {{ ticket.fecha }}
                                                td {{ ticket.aceptado }}
                                                td
                                                    a(href='{{ ticket.downloadPath }}', download='') {{ ticket.filename }}

                                .col-md-4
                                    .well.well-sm
                                        h3 Agregar nueva informacion a este ticket
                                        form(action="/ticketDataCrud/create", method="POST", encType="multipart/form-data")
                                            center
                                                input#ticketIdForm(name="ticketId", hidden="")
                                                textarea#ticketData(name="ticketData", required='')
                                                br
                                                h4 Adjuntar archivo
                                                input#fileTicket.btn.btn-lg(type='file', name='fileTicket')
                                                br
                                                button.btn.btn-success.btn-lg(name='submitButton', value='assign') Agregar datos al ticket
                                if usertype == 1
                                    .col-md-4
                                        .well.well-sm
                                            h3 Aplazar este ticket a la siguiente fecha:
                                            center
                                                form(action="/ticketCrud/changeDate", method="POST")
                                                    input#newDate(name='newDate', type='date')
                                                    br
                                                    br
                                                    input(name="ticketId", hidden="")
                                                    button.btn.btn-warning.btn-lg(name='submitButton', value='postpone') Aplazar Ticket

                                    .col-md-4
                                        .well.well-sm
                                            h3 Eliminar ticket
                                            br
                                            br
                                            center
                                                form(action="/ticketCrud/delete", method="POST", onsubmit="return window.confirm('¿Esta seguro que desea eliminar este ticket?')")
                                                    input(name="ticketId", hidden="")
                                                    button.btn.btn-danger.btn-lg(name='submitButton', value='delete') Eliminar este ticket
                                            br

                                if usertype == 1 || usertype == 2
                                    .col-md-4
                                        .well.well-sm
                                            h3 Asignar este ticket al siguiente operador:
                                            center
                                                form(action="/ticketCrud/assign", method="POST")
                                                    input#ticketIdForm(name="ticketId", hidden="")
                                                    select#operadorId(name="operadorId", required="")
                                                        option(ng-repeat="user in usersData", value="{{ user.id }}") {{ user.username }}
                                                    br
                                                    br
                                                    button.btn.btn-info.btn-lg(name='submitButton', value='assign') Asignar ticket

                                if usertype == 2
                                    .col-md-4
                                        .well.well-sm
                                            h3 Des-eliminar este ticket:
                                            center
                                                form(action="/ticketCrud/de-delete", method="POST")
                                                    input(name="ticketId", hidden="")
                                                    br
                                                    br
                                                    button#de-delete.btn.btn-danger.btn-lg(name='submitButton', value='de-delete', disabled="") Des-eliminar ticket




            form(action="/users/viewTickets", method="GET")
                button.btn.btn-primary.btn-lg Volver atrás



    script(src="/js/toggleMenu.js")
    script(src='/angular/viewTicketId.js')
